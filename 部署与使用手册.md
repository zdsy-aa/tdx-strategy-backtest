# 股票策略回测与分析系统 - 部署与使用手册

**版本**: 2.1.0
**更新日期**: 2026-01-16

---

## 1. 环境要求与配置

### 1.1. 软件要求

| 软件 | 版本 | 用途 |
| :--- | :--- | :--- |
| **操作系统** | Linux, macOS, Windows | 运行环境 |
| **Python** | 3.8 或更高版本 | 后端脚本运行 |
| **Node.js** | 16.0 或更高版本 | 前端应用运行 |
| **Git** | 最新版 | 克隆代码仓库 |

### 1.2. 环境配置

#### Python 环境

建议使用虚拟环境以隔离项目依赖。

```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境 (Linux/macOS)
source venv/bin/activate

# 激活虚拟环境 (Windows)
.\venv\Scripts\activate

# 安装依赖
pip install -r requirements.txt
```

#### Node.js 环境

推荐使用 `pnpm` 作为包管理器。

```bash
# 全局安装 pnpm
npm install -g pnpm

# 进入 web 目录
cd web

# 安装依赖
pnpm install
```

---

## 2. 安装与使用流程

### 第1步：克隆代码仓库

```bash
# 克隆仓库
git clone https://github.com/zdsy-aa/tdx-strategy-backtest.git

# 进入项目目录
cd tdx-strategy-backtest
```

### 第2步：安装依赖

请参考 **1.2. 环境配置** 部分完成Python和Node.js的依赖安装。

### 第3步：下载股票数据

这是所有分析的基础。脚本提供了多种下载模式。

```bash
# 确保在 py_file 目录下
cd py_file

# 模式一：首次使用，下载全部历史数据 (耗时较长)
python3 data_fetcher.py --full

# 模式二：每日收盘后，增量更新当天数据 (速度快)
python3 data_fetcher.py --today

# 模式三：下载指定日期范围内的数据并覆盖本地 (用于修复数据)
python3 data_fetcher.py --date 20260101 20260115
```

### 第4步：运行回测与分析脚本

您可以根据需要运行以下任意脚本。所有脚本都会自动将结果输出到Web目录。

```bash
# 确保在 py_file 目录下

# (可选) 运行单指标策略回测
python3 single_strategy_backtest.py

# (可选) 运行组合策略回测
python3 combo_strategy_backtest.py

# (可选) 运行信号成功案例扫描与分析
python3 signal_success_scanner.py
python3 pattern_analyzer.py
```

### 第5步：启动Web前端服务

```bash
# 确保在 web 目录下
cd web

# 启动开发服务器
pnpm dev
```

启动成功后，在浏览器中打开 `http://localhost:5173` 即可查看结果。

---

## 3. 脚本命令行参数

### `single_strategy_backtest.py`

- `--strategy [all|six_veins|buy_sell|chan|sell_optimize]`: 指定运行策略，默认为`all`。
- `--limit [整数]`: 限制处理的股票数量，用于快速测试。

### `combo_strategy_backtest.py`

- `--strategy [all|steady|aggressive]`: 指定运行组合策略，默认为`all`。
- `--limit [整数]`: 限制处理的股票数量。

**示例**：快速测试稳健组合策略在100只股票上的表现。

```bash
python3 combo_strategy_backtest.py --strategy steady --limit 100
```

---

**手册结束**
