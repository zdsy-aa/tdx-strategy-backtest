# 股票策略回测与分析系统 - 部署与使用手册

**版本**: 3.0.0
**更新日期**: 2026-01-16
**作者**: Manus AI

---

## 1. 环境要求与配置

### 1.1. 软件要求

| 软件 | 推荐版本 | 用途 |
| :--- | :--- | :--- |
| **Python** | 3.8 或更高版本 | 后端脚本运行，数据处理 |
| **Node.js** | 16.0 或更高版本 | 前端应用运行，构建 |
| **pnpm** | 最新版 | 前端包管理工具 |
| **Git** | 最新版 | 代码版本管理 |

### 1.2. 环境配置

#### Python 环境配置

1.  **创建并激活虚拟环境**：
    ```bash
    # 在项目根目录执行
    python3 -m venv venv
    
    # 激活环境 (Linux/macOS)
    source venv/bin/activate
    
    # 激活环境 (Windows PowerShell)
    .\venv\Scripts\Activate.ps1
    ```
2.  **安装依赖**：
    ```bash
    pip install -r requirements.txt
    ```

#### Node.js 环境配置

1.  **安装 pnpm**：
    ```bash
    # 全局安装 pnpm
    npm install -g pnpm
    ```
2.  **安装前端依赖**：
    ```bash
    # 进入 web 目录
    cd web
    pnpm install
    # 返回项目根目录
    cd ..
    ```

---

## 2. 核心使用流程

### 2.1. 步骤一：数据获取与更新

所有数据操作都在 `py_file/` 目录下进行。

| 目的 | 命令行 | 详细说明 |
| :--- | :--- | :--- |
| **首次全量下载** | `python3 data_fetcher_1.py --full` | 下载所有A股和指数的历史日线数据，耗时较长。 |
| **日常增量更新** | `python3 data_fetcher_1.py --today` | 仅更新最新的交易日数据，速度快。 |
| **数据修复/重载** | `python3 data_fetcher_1.py --date 20260101 20260115` | 下载并覆盖指定日期范围的数据。 |

### 2.2. 步骤二：运行分析与回测脚本

运行这些脚本将生成Web前端所需的数据文件。

| 脚本文件 | 对应Web模块 | 输出数据文件 | 脚本功能简述 |
| :--- | :--- | :--- | :--- |
| `2_single_strategy_backtest.py` | **回测报告** (单策略) | `web/client/src/data/backtest_single.json` | 运行六脉神剑、缠论等单指标策略回测。 |
| `2_combo_strategy_backtest.py` | **回测报告** (组合策略) | `web/client/src/data/backtest_combo.json` | 运行稳健型、激进型组合策略回测。 |
| `2_signal_success_scanner.py` | **分析报告** (信号统计) | `web/client/src/data/signal_summary.json` | 扫描全市场信号，统计成功率。 |
| `2_1_pattern_analyzer.py` | **分析报告** (模式分析) | `web/client/src/data/pattern_summary.json` | 分析成功案例的共性模式。 |

### 2.3. 步骤三：启动Web前端服务

```bash
# 确保在项目根目录
cd web
pnpm dev
```
在浏览器中打开终端显示的地址（通常是 `http://localhost:5173`）。

---

## 3. 脚本参数详解

### 3.1. `data_fetcher_1.py`

| 参数 | 格式 | 描述 |
| :--- | :--- | :--- |
| `--full` | 无 | 全量下载所有数据。 |
| `--today` | 无 | 仅下载当日数据。 |
| `--date` | `YYYYMMDD YYYYMMDD` | 下载指定日期范围的数据。 |
| `--stock` | `股票代码` | 下载指定股票数据，如 `000001`。 |
| `--index` | `指数代码` | 下载指定指数数据，如 `sh000300`。 |

### 3.2. `2_single_strategy_backtest.py`

| 参数 | 格式 | 描述 |
| :--- | :--- | :--- |
| `--strategy` | `[all|six_veins|buy_sell|chan|sell_optimize]` | 指定运行的策略，默认为 `all`。 |
| `--limit` | `[整数]` | 限制处理的股票数量，用于快速测试。 |

**示例**: 仅回测缠论策略，并限制在100只股票上。
```bash
python3 2_single_strategy_backtest.py --strategy chan --limit 100
```

### 3.3. `2_combo_strategy_backtest.py`

| 参数 | 格式 | 描述 |
| :--- | :--- | :--- |
| `--strategy` | `[all|steady|aggressive]` | 指定运行的组合策略，默认为 `all`。 |
| `--limit` | `[整数]` | 限制处理的股票数量。 |

---

**文档结束**
