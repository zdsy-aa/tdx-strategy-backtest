# 通达信交易指标参考系统 (TradeGuide)

> 基于六脉神剑、买卖点、摇钱树等核心指标构建的量化交易策略体系。提供稳健、激进、共振等多种组合方案，助您在不同市场环境下做出更优决策。

## 📁 项目结构

```
tdx-strategy-backtest/
├── README.md                 # 项目总览（本文件）
├── data/                     # 数据目录
│   └── day/                  # 日线数据存储
│       └── {股票代码}.csv    # 单只股票的日线数据
├── py_file/                  # Python 脚本目录
│   ├── README.md             # 脚本功能说明
│   ├── indicators.py         # 核心指标计算模块
│   ├── data_fetcher.py       # 数据下载模块
│   ├── 101_*.py              # 单指标测试脚本（101-199）
│   ├── 201_*.py              # 组合指标测试脚本（201-299）
│   └── scheduled_data_update.py  # 定时任务脚本
├── report/                   # 回测报告目录
│   ├── README.md             # 报告目录说明
│   ├── summary/              # 总体报告
│   ├── yearly/               # 年度报告
│   └── monthly/              # 月度报告
├── web/                      # 网站代码目录
│   ├── README.md             # 网站说明文档
│   ├── client/               # 前端代码（React + TypeScript）
│   │   ├── index.html        # 入口HTML
│   │   ├── public/           # 静态资源
│   │   └── src/              # 源代码
│   │       ├── pages/        # 页面组件
│   │       ├── components/   # 公共组件
│   │       └── data/         # 静态数据
│   ├── server/               # 后端代码（Node.js + tRPC）
│   ├── shared/               # 前后端共享代码
│   ├── drizzle/              # 数据库迁移文件
│   ├── package.json          # Node.js依赖配置
│   └── vite.config.ts        # Vite构建配置
├── ideas.md                  # 功能想法记录
└── todo.md                   # 待办事项
```

## 🚀 快速开始

### 环境要求

- **Python**: 3.8 或更高版本
- **Node.js**: 18 或更高版本
- **pnpm**: 8 或更高版本

### 第一步：克隆项目

```bash
git clone https://github.com/zdsy-aa/tdx-strategy-backtest.git
cd tdx-strategy-backtest
```

### 第二步：设置 Python 环境

```bash
# 创建虚拟环境
python3 -m venv venv

# 激活虚拟环境
# Linux/Mac:
source venv/bin/activate
# Windows:
# venv\Scripts\activate

# 安装 Python 依赖
pip install pandas numpy akshare matplotlib
```

### 第三步：下载历史数据

```bash
cd py_file

# 下载默认股票列表的历史数据
python data_fetcher.py

# 或下载指定股票
python data_fetcher.py --stock 000001

# 或下载指定指数
python data_fetcher.py --index sh000300

# 只更新当天数据
python data_fetcher.py --today
```

### 第四步：运行回测

```bash
# 单指标测试 - 六脉神剑
python 101_six_veins_test.py

# 单指标测试 - 买卖点
python 102_buy_sell_points_test.py

# 组合指标测试 - 稳健组合
python 201_steady_combo_test.py

# 组合指标测试 - 激进组合
python 202_aggressive_combo_test.py
```

### 第五步：启动网站

```bash
# 进入web目录
cd ../web

# 安装前端依赖
pnpm install

# 启动开发服务器
pnpm dev
```

网站将在 http://localhost:5173 启动。

## 📊 核心指标

| 指标名称 | 类型 | 适用周期 | 可靠性 | 说明 |
|---------|------|---------|--------|------|
| **六脉神剑** | 综合指标 | 中短线 | 高 | 六个技术指标共振系统 |
| **买卖点** | 主力追踪 | 中线 | 较高 | 庄家散户线交叉系统 |
| **缠论买点** | 结构分析 | 中长线 | 高 | 笔结构买点识别 |
| **摇钱树** | 选股信号 | 短线 | 中等 | 三重过滤选股系统 |

### 六脉神剑六大指标

| 指标 | 名称 | 红色条件 |
|------|------|---------|
| MACD | 移动平均收敛发散 | DIF > DEA |
| KDJ | 随机指标 | K > D |
| RSI | 相对强弱指数 | RSI5 > RSI13 |
| LWR | 威廉指标变种 | LWR1 > LWR2 |
| BBI | 多空分界线 | 收盘价 > BBI |
| MTM | 动量指标 | MTM1 > MTM2 |

## 🎯 指标方案

### 单指标买入方案

| 方案名称 | 触发条件 | 建议持有周期 |
|---------|---------|-------------|
| 六脉6红 | 六脉神剑六个指标同时变红 | 15-30天 |
| 六脉5红 | 六脉神剑五个指标同时变红 | 10-20天 |
| 买点2 | 买卖点指标出现买点2信号 | 10-15天 |
| 缠论二买 | 缠论出现二买信号 | 20-30天 |
| 摇钱树 | 摇钱树指标出现买入信号 | 5-10天 |

### 组合指标方案

#### 稳健型（适合保守投资者）
- **信号组合**：六脉5红 + 买点2 + 缠论二买
- **持有周期**：15-30天
- **历史胜率**：约 62.5%

#### 激进型（适合风险偏好者）
- **信号组合**：六脉4红 + 买点2
- **持有周期**：5-10天
- **历史胜率**：约 58.3%

#### 共振型（最高可靠性）
- **信号组合**：六脉6红 + 买点2 + 摇钱树
- **持有周期**：动态调整
- **历史胜率**：约 70%+

## 📈 回测结果统计

回测结果分为三个维度：

### 总数据统计
基于全部历史数据的回测结果。

### 年度数据统计
按年份分组的回测结果，便于观察策略在不同年份的表现。

### 月度数据统计
按月份分组的回测结果，便于观察策略的季节性表现。

| 策略 | 最优周期 | 总胜率 | 平均收益 |
|------|---------|-------|---------|
| 六脉神剑（6红） | 28天 | 54.4% | 0.77% |
| 买点2 | 16天 | 83.3% | 1.11% |
| 三信号共振 | 2天 | 77.8% | 0.60% |
| 稳健组合 | 15天 | 62.5% | 0.85% |

## 🔧 Python 脚本编号规则

### 单指标测试（101-199）
| 编号 | 脚本名称 | 测试内容 |
|------|---------|---------|
| 101 | 101_six_veins_test.py | 六脉神剑指标测试 |
| 102 | 102_buy_sell_points_test.py | 买卖点指标测试 |
| 103 | 103_chan_lun_test.py | 缠论买点测试 |
| 104 | 104_money_tree_test.py | 摇钱树指标测试 |

### 组合指标测试（201-299）
| 编号 | 脚本名称 | 测试内容 |
|------|---------|---------|
| 201 | 201_steady_combo_test.py | 稳健组合测试 |
| 202 | 202_aggressive_combo_test.py | 激进组合测试 |
| 203 | 203_resonance_combo_test.py | 共振组合测试 |

## ⏰ 定时任务

系统配置了每日 15:30 自动下载当天日线数据的定时任务：

```bash
# 手动设置 crontab
30 15 * * 1-5 cd /path/to/py_file && python scheduled_data_update.py
```

## 🌐 网站功能

1. **仪表盘**：系统概览和核心策略展示
2. **指标详解**：每个指标的计算公式和信号说明
3. **指标方案**：单指标和组合指标的策略推荐
4. **回测数据**：历史回测结果可视化（总/年/月数据）
5. **报告明细**：Excel样式的详细回测报告
6. **AI 策略优化**：通过自然语言描述调整策略
7. **自定义策略**：自由组合指标并回测

## 📋 数据文件格式

### 日线数据 CSV 格式

| 列名 | 说明 | 示例 |
|------|------|------|
| date | 日期 | 2024-01-15 |
| open | 开盘价 | 10.50 |
| high | 最高价 | 10.80 |
| low | 最低价 | 10.30 |
| close | 收盘价 | 10.65 |
| volume | 成交量 | 1000000 |
| amount | 成交额 | 10500000 |
| pct_change | 涨跌幅 | 1.52 |
| code | 股票代码 | 000001 |

## ⚠️ 免责声明

本系统仅供学习研究使用，不构成任何投资建议。股市有风险，投资需谨慎。

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request。

## 📞 联系方式

如有问题，请通过 GitHub Issues 联系。
