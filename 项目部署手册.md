# 股票策略回测与分析系统 - 多平台部署手册

**版本**: 3.0.0
**更新日期**: 2026-01-16
**作者**: Manus AI

---

## 1. 部署环境要求

本系统采用前后端分离架构，对运行环境要求较低，核心依赖于 **Python** 和 **Node.js** 环境。

| 依赖 | 推荐版本 | 备注 |
| :--- | :--- | :--- |
| **Python** | 3.8+ | 核心后端环境，用于数据处理和回测。 |
| **Node.js** | 16.0+ | 核心前端环境，用于Web应用构建和运行。 |
| **Git** | 最新版 | 用于克隆代码仓库。 |
| **pnpm** | 最新版 | 推荐的前端包管理器，比npm/yarn更高效。 |

---

## 2. 跨平台通用部署步骤

以下步骤适用于所有操作系统，请确保已安装上述依赖。

### 步骤 2.1: 克隆代码仓库

打开终端（Windows用户推荐使用 Git Bash 或 PowerShell），执行以下命令：

```bash
# 克隆代码仓库
git clone https://github.com/zdsy-aa/tdx-strategy-backtest.git

# 进入项目目录
cd tdx-strategy-backtest
```

### 步骤 2.2: 配置 Python 环境 (后端)

强烈建议使用虚拟环境，以避免依赖冲突。

```bash
# 1. 创建虚拟环境
python3 -m venv venv

# 2. 激活虚拟环境
# Linux/macOS:
source venv/bin/activate
# Windows (PowerShell):
.\venv\Scripts\Activate.ps1

# 3. 安装 Python 依赖
pip install -r requirements.txt
```

### 步骤 2.3: 配置 Node.js 环境 (前端)

我们使用 `pnpm` 作为前端包管理器。

```bash
# 1. 全局安装 pnpm (如果未安装)
npm install -g pnpm

# 2. 进入 web 目录
cd web

# 3. 安装前端依赖
pnpm install

# 4. 返回项目根目录
cd ..
```

---

## 3. 平台专项部署指南

### 3.1. Windows 平台 (Windows 10/11)

#### 依赖安装细节

1.  **Python**: 访问 [Python官网](https://www.python.org/downloads/) 下载安装包。**安装时务必勾选 “Add Python to PATH”**。
2.  **Node.js**: 访问 [Node.js官网](https://nodejs.org/en/download) 下载LTS版本安装包，一路默认安装即可。
3.  **Git**: 访问 [Git官网](https://git-scm.com/download/win) 下载安装包，默认安装即可。

#### 常见问题与解决方案

| 问题 | 解决方案 |
| :--- | :--- |
| **`python` 或 `pip` 命令找不到** | 检查安装时是否勾选了 “Add Python to PATH”，或手动将Python安装目录添加到系统环境变量。 |
| **PowerShell 激活虚拟环境失败** | 以管理员身份运行PowerShell，执行 `Set-ExecutionPolicy RemoteSigned`，选择 `Y` 允许执行本地脚本。 |
| **`pnpm` 安装失败** | 尝试以管理员身份运行终端，或使用 `corepack enable` 命令启用 Node.js 自带的包管理器。 |

### 3.2. Linux 平台 (通用指南)

适用于 Debian/Ubuntu/CentOS 等发行版。

#### 依赖安装细节

```bash
# 1. 更新系统并安装基础工具
sudo apt update && sudo apt upgrade -y
sudo apt install -y git python3 python3-pip python3-venv

# 2. 安装 Node.js (推荐使用 nvm)
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.7/install.sh | bash
source ~/.bashrc # 或重启终端
nvm install 16 # 安装推荐的 Node.js 版本
nvm use 16

# 3. 安装 pnpm
npm install -g pnpm
```

### 3.3. macOS 平台

推荐使用 Homebrew 进行包管理。

#### 依赖安装细节

```bash
# 1. 安装 Homebrew (如果未安装)
/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"

# 2. 安装 Python
brew install python@3.11 # 或更高版本

# 3. 安装 Node.js (推荐使用 nvm，参考 Linux 步骤)
# 或直接使用 Homebrew 安装 Node.js
brew install node

# 4. 安装 pnpm
npm install -g pnpm
```

---

## 4. 运行项目

完成部署后，请参考 **《部署与使用手册.md》** 中的 **2. 核心使用流程** 运行项目。

**简要回顾：**

1.  **数据下载**: `python3 py_file/data_fetcher_1.py --full`
2.  **运行回测**: `python3 py_file/2_single_strategy_backtest.py` 等
3.  **启动Web**: `cd web && pnpm dev`

---

**文档结束**
